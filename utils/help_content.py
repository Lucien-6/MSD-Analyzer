# 帮助文档内容

def get_help_content():
    """返回帮助文档内容"""
    return """

# MSD Analyzer V1.1 使用指南
###
## 简介
**MSD Analyzer**是一个专业的粒子平均位移平方(Mean Squared Displacement, MSD)分析工具，专为研究布朗运动、扩散过程和微观粒子动力学而设计。本软件支持多种扩散模型分析，包括正常或反常布朗运动、带漂移的布朗运动和受限扩散等。
###
## 作者信息
- **作者**：Lucien
- **EMAIL**：luicen-6@qq.com
###
## 基本工作流程
1. 加载数据
2. 设置分析参数
3. 计算MSD
4. 拟合MSD曲线
5. 进行标度律分析
6. 保存结果和生成报告
###
---
###
## 详细步骤
###
### 1. 加载数据
- 点击"**加载数据**"按钮
- 支持的文件格式：
  * **Excel文件**(.xlsx或.xls格式)
  * **CSV文件**(.csv格式)
- Excel数据格式要求：
  * 每个粒子的轨迹数据应包含时间列和坐标列
  * 第一行为标题行，包含T、X、Y三列(2D运动)或T、X、Y、Z四列(3D运动)
  * 不同颗粒的轨迹应保存在不同sheet中
  * 每个颗粒的ID就是它的sheet名称
- CSV数据格式要求：
  * 第一行为标题行，包含T、X、Y三列(2D运动)或T、X、Y、Z四列(3D运动)
  * 可用"particle_id"列来区分不同的颗粒，如果没有此列，所有数据将被视为单个颗粒
- 数据加载后，程序会自动检测轨迹维度(2D或3D)并显示轨迹图
###
### 2. 单位设置
- 时间单位：**s**(秒)、**ms**(毫秒)、**min**(分钟)、**h**(小时)
- 空间单位：**m**(米)、**mm**(毫米)、**μm**(微米)、**nm**(纳米)
- 单位设置仅影响图表和结果的单位显示，不改变原始数值计算
- ⚠️ **重要提示**：请在加载数据前设置好单位，中途更改需要重新加载数据并从头处理！
###
### 3. 扩散模型设置
- **简单扩散模型**：适用于纯布朗运动的扩散过程
  * 拟合公式：MSD(t) = 2 * d * D * t (d为维度，D为扩散系数)
- **定向扩散模型**：适用于有定向运动的扩散过程 (漂移速度恒定)
  * 拟合公式：MSD(t) = 2 * d * D * t + V² * t² (V为漂移速度)
- **受限扩散模型**：适用于在有限空间内的扩散 (圆内或球内)
  * 拟合公式：MSD(t) = L² * (1-exp(-2 * d * D * t / L²)) (L为约束长度)
###
### 4. 拟合设置
- **自动拟合模式**：
  * 程序通过分析RDC(动态扩散系数曲线)自动确定最佳拟合区间
  * 设置起始时间：指定从哪个时间点开始寻找拟合区间
  * 拟合优度阈值(R²)：设置接受拟合结果的最低R²值
  * 程序会寻找满足R²阈值的最长区间
  * ⚠️ 自动拟合模式不适用于受限扩散模型！
- **手动拟合模式**：
  * 手动指定拟合的起始时间和终止时间
  * 适用于需要精确控制拟合区间的情况
###
### 5. 颗粒选择与轨迹管理
- 颗粒列表显示所有已加载的颗粒ID
- 可以选择排除某些颗粒不参与分析
- 轨迹图交互功能：
  * **左键点击**某条轨迹：只显示该轨迹
  * **右键点击**某条轨迹：隐藏该轨迹
  * **双击空白处**：恢复显示所有轨迹
  * ▲ 为轨迹起点，● 为轨迹终点
###
### 6. 计算MSD
- 点击"**计算MSD**"按钮
- 程序会计算：
  * 每个粒子的单独MSD
  * 所有粒子的平均MSD
  * 动态扩散系数(RDC)
- 计算过程会根据数据量自动选择串行或并行计算
  * 当粒子数量>10或总计算量>100000时，自动启用并行计算
  * 并行计算会利用多核CPU加速处理
- 计算完成后会生成三种图表：
  * **MSD图**：显示每个粒子的MSD和平均MSD随时间的变化
  * **统计量图**：显示每个时间点参与平均的粒子数量
  * **RDC图**：显示动态扩散系数随时间的变化
- ⚠️ 此步最为耗时，请耐心等待！
###
### 7. 拟合MSD
- 点击"**拟合MSD**"按钮
- 程序会根据选择的模型和拟合设置拟合MSD曲线
- 拟合结果包括：
  * 扩散系数D及其95%置信区间
  * 漂移速度V及其95%置信区间(定向扩散模型)
  * 约束长度L及其95%置信区间(受限扩散模型)
  * 拟合优度R²
  * 拟合使用的时间范围
- 拟合曲线会叠加在MSD图上显示
###
### 8. 标度律分析
- 点击"**标度律分析**"按钮
- 程序会分析MSD随时间的标度关系：MSD ~ t^α
- 分析方法：对MSD和时间取双对数，进行线性拟合
- 分析结果包括：
  * 标度指数α及其95%置信区间
  * 比例系数K及其95%置信区间
  * 拟合优度R²
- 生成双对数MSD图，显示标度关系
###
### 9. 保存结果
- 点击"**完成并保存**"按钮
- 选择保存目录
- 程序会保存以下内容：
  * 所有图表(PNG格式)：轨迹图、MSD图、RDC图、标度律图等
  * 分析结果(Excel格式)：包含所有数值结果和统计信息
  * 综合报告(PDF格式)：包含所有图表和分析结果的完整报告
- 保存的文件会按照分析日期和时间命名
###
---
###
## 结果解读
###
### 扩散系数(D)
- **单位**：空间单位²/时间单位
- **物理意义**：反映粒子扩散的快慢
- **典型值参考**：
  * 水中微米级粒子：~10⁻¹²-10⁻¹⁴ m²/s
  * 细胞内蛋白质：~10⁻¹¹-10⁻¹² m²/s
- **影响因素**：温度、介质粘度、粒子尺寸
###
### 漂移速度(V)
- **单位**：空间单位/时间单位
- **物理意义**：反映粒子在重力或其他外力作用下的定向漂移速度
- **方向**：应始终维持不变
- **斯托克斯沉降速度参考**：V = 2(ρₚ-ρₘ)gr²/9η
  * ρₚ：粒子密度
  * ρₘ：介质密度
  * g：重力加速度
  * r：粒子半径
  * η：介质粘度
###
### 约束长度(L)
- **单位**：空间单位
- **物理意义**：受限扩散中粒子运动的特征约束尺寸
- **应用**：细胞内区室尺寸、多孔材料孔径等估计
###
### 标度指数(α)
- MSD ~ t^α
- **扩散类型判断**：
  * α = 1(±0.1)：**简单扩散**(布朗运动)
  * α < 0.9：**次扩散**(受阻扩散)
    - 可能原因：分子拥挤、粘弹性介质、粒子间相互作用
  * α > 1.1：**超扩散**(定向或活性运动)
    - 可能原因：主动运输、流体对流、非平衡系统
###
---
###
## 高级功能与技巧
- **数据预处理**：
  * 对于噪声较大的数据，可以先排除异常颗粒再进行分析
- **拟合策略**：
  * 短时间尺度：反映局部扩散行为
  * 长时间尺度：反映整体扩散趋势
  * 拟合优度(R²)越接近1，拟合质量越高
- **模型选择**：
  * 如果并不确定，建议先选择简单扩散模型
  * 如果α明显大于1且有定向趋势，选择定向扩散模型
  * 如果MSD曲线在长时间趋于平台，选择受限扩散模型
- **拟合模式**：
  * 对于长时间大批量轨迹数据，建议使用自动拟合模式找到最佳拟合区间
- **图片调整与导出**
  * 在应用GUI界面中可通过图表左上角操作栏进行调整与导出
- **帮助文档**：
  * 双击"单位设置"标题栏可随时打开本帮助文档
  * 在分析过程中遇到问题时参考本文档
###
---
###
## 常见问题解答
###
### Q: 为什么我的MSD曲线在长时间尺度上不稳定？
A: 长时间尺度的MSD计算涉及较少的数据点平均，统计误差较大。建议关注统计量图，在参与平均的粒子数量充足的时间范围内进行分析。
###
### Q: 如何判断使用哪种扩散模型？
A: 先进行标度律分析，根据α值初步判断扩散类型，再选择相应模型进行拟合。也可以尝试不同模型，比较R²值选择最佳模型。
###
### Q: 为什么自动拟合找不到满足R²阈值的区间？
A: 可能是R²阈值设置过高或数据质量不佳。尝试降低R²阈值或切换到手动拟合模式。
###
### Q: 如何处理不同时间间隔或不同长度的轨迹数据？
A: 程序会自动处理不规则时间间隔或不同长度的数据，无需特殊处理。
###
"""